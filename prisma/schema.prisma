datasource db {
  provider = "sqlite"
  url      = "file:./dev.db"
}

generator client {
  provider = "prisma-client-js"
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String
  name      String?
  createdAt DateTime @default(now())
}

model Order {
  id            String      @id @default(uuid())
  customerEmail String
  trackingCode  String      @unique
  createdAt     DateTime    @default(now())
  status        String
  funnelSteps   FunnelStep[]
}

model FunnelStep {
  id          String    @id @default(uuid())
  orderId     String
  order       Order     @relation(fields: [orderId], references: [id])
  templateId  String
  template    EmailTemplate @relation(fields: [templateId], references: [id])
  status      String
  sentAt      DateTime?
  attempts    Int       @default(0)
  error       String?
}

model EmailTemplate {
  id             String       @id @default(uuid())
  name           String
  subject        String
  content        String
  delayHours     Int
  payment_method String?
  is_active      Boolean     @default(true)
  created_at     DateTime    @default(now())
  updated_at     DateTime    @updatedAt
  steps          FunnelStep[]
}